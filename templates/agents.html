{% extends "base.html" %}

{% block title %}{{ section.title }} | {{ config.title }}{% endblock %}

{% block head %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
<style>
    /* Syntax highlighting colors (Catppuccin Mocha) */
    :root {
        --sh-bg: #1e1e2e;
        --sh-text: #cdd6f4;
        --sh-muted: #6c7086;
        --sh-green: #a6e3a1;
        --sh-mauve: #cba6f7;
        --sh-blue: #89b4fa;
        --sh-yellow: #f9e2af;
        --sh-peach: #fab387;
        --sh-sky: #89dceb;
        --sh-lavender: #b4befe;
        --sh-red: #f38ba8;
        --sh-pink: #f5c2e7;
        --sh-teal: #94e2d5;
        --sh-border: #313244;
    }
    [data-theme="light"] {
        --sh-bg: #eff1f5;
        --sh-text: #4c4f69;
        --sh-muted: #9ca0b0;
        --sh-green: #40a02b;
        --sh-mauve: #8839ef;
        --sh-blue: #1e66f5;
        --sh-yellow: #df8e1d;
        --sh-peach: #fe640b;
        --sh-sky: #04a5e5;
        --sh-lavender: #7287fd;
        --sh-red: #d20f39;
        --sh-pink: #ea76cb;
        --sh-teal: #179299;
        --sh-border: #ccd0da;
    }
    /* Override Prism theme */
    code[class*="language-"],
    pre[class*="language-"] {
        background: var(--sh-bg) !important;
        color: var(--sh-text) !important;
        text-shadow: none !important;
        font-family: 'Geist Mono', ui-monospace, monospace !important;
        font-size: 0.875rem !important;
        line-height: 1.6 !important;
    }
    pre[class*="language-"] {
        padding: 1.25rem !important;
        border-radius: 8px !important;
        border: 1px solid var(--sh-border) !important;
        overflow-x: auto !important;
    }
    .token.comment,
    .token.prolog,
    .token.doctype,
    .token.cdata { color: var(--sh-muted) !important; font-style: italic; }
    .token.string,
    .token.char,
    .token.attr-value { color: var(--sh-green) !important; }
    .token.keyword,
    .token.control,
    .token.directive,
    .token.unit { color: var(--sh-mauve) !important; }
    .token.function,
    .token.function-name { color: var(--sh-blue) !important; }
    .token.class-name,
    .token.type-class-name,
    .token.builtin { color: var(--sh-yellow) !important; }
    .token.number,
    .token.boolean { color: var(--sh-peach) !important; }
    .token.operator,
    .token.arrow { color: var(--sh-sky) !important; }
    .token.punctuation { color: var(--sh-muted) !important; }
    .token.property,
    .token.node { color: var(--sh-lavender) !important; }
    .token.attr-name,
    .token.variable,
    .token.parameter { color: var(--sh-red) !important; }
    .token.symbol,
    .token.atom { color: var(--sh-pink) !important; }
    .token.module,
    .token.namespace { color: var(--sh-teal) !important; }
    /* Code example styling - override site defaults */
    .code-example pre,
    .config-example {
        margin: 0 !important;
    }
    .code-panel,
    .config-example {
        background: var(--sh-bg) !important;
        padding: 1.25rem !important;
        border-radius: 8px !important;
        border: 1px solid var(--sh-border) !important;
        overflow-x: auto !important;
    }
    .code-panel code,
    .config-example code {
        background: transparent !important;
        color: var(--sh-text) !important;
        font-family: 'Geist Mono', ui-monospace, monospace !important;
        font-size: 0.875rem !important;
    }
    /* Ensure Prism tokens override base code color */
    .code-panel .token,
    .config-example .token {
        background: transparent !important;
    }
    /* Protocol documentation links */
    .protocol-docs-links {
        margin: 1.5rem 0;
        padding: 1.25rem;
        background: var(--color-bg-subtle, #1e1e2e);
        border-radius: 8px;
        border: 1px solid var(--color-border, #313244);
    }
    .protocol-docs-links h4 {
        margin: 0 0 1rem;
        font-size: 0.875rem;
        font-weight: 600;
        color: var(--color-text-secondary, #a6adc8);
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }
    .docs-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 0.75rem;
    }
    .doc-link {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.625rem 0.875rem;
        font-size: 0.875rem;
        font-weight: 500;
        color: var(--color-text, #cdd6f4);
        background: var(--color-bg, #11111b);
        border: 1px solid var(--color-border, #313244);
        border-radius: 6px;
        text-decoration: none;
        transition: all 0.15s ease;
    }
    .doc-link:hover {
        color: var(--color-primary, #cba6f7);
        border-color: var(--color-primary, #cba6f7);
        background: rgba(203, 166, 247, 0.1);
        text-decoration: none;
    }
    .doc-link svg {
        flex-shrink: 0;
        opacity: 0.7;
    }
    .doc-link:hover svg {
        opacity: 1;
    }
    /* Why Agents section */
    .why-agents {
        padding: 0.5rem 0;
    }
    .philosophy-content {
        margin-bottom: 1.5rem;
    }
    .philosophy-content p {
        margin: 0 0 1rem;
        font-size: 0.9375rem;
        line-height: 1.7;
        color: var(--color-text-secondary, #bac2de);
    }
    .philosophy-content p:last-child {
        margin-bottom: 0;
    }
    .philosophy-content strong {
        color: var(--color-text, #cdd6f4);
    }
    .philosophy-content em {
        color: var(--color-primary, #cba6f7);
        font-style: normal;
        font-weight: 500;
    }
    .philosophy-principles {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 1rem;
        margin-top: 1.5rem;
        padding-top: 1.5rem;
        border-top: 1px solid rgba(203, 166, 247, 0.15);
    }
    .principle {
        display: flex;
        align-items: flex-start;
        gap: 0.75rem;
    }
    .principle-icon {
        flex-shrink: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        width: 36px;
        height: 36px;
        background: rgba(203, 166, 247, 0.15);
        border-radius: 8px;
        color: var(--color-primary, #cba6f7);
    }
    .principle-text {
        display: flex;
        flex-direction: column;
        gap: 0.125rem;
    }
    .principle-text strong {
        font-size: 0.875rem;
        font-weight: 600;
        color: var(--color-text, #cdd6f4);
    }
    .principle-text span {
        font-size: 0.8125rem;
        color: var(--color-text-muted, #6c7086);
    }
</style>
{% endblock head %}

{% block content %}
<div class="page-header">
    <div class="container">
        <h1><span class="gradient-text">{{ section.title }}</span></h1>
        <p>{{ section.description }}</p>
    </div>
</div>

<section class="agents-section">
    <div class="container">
        {# Search bar #}
        <div class="agents-search">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
            <input type="text" id="agent-search" placeholder="Search agents..." autocomplete="off">
        </div>

        {# Separate official and community agents #}
        {% set official_agents = section.pages | filter(attribute="extra.official", value=true) %}
        {% set community_agents = section.pages | filter(attribute="extra.official", value=false) | sort(attribute="title") %}

        {# Sort official agents by status: Stable first, then Beta, then Alpha, then Planned, then Deprecated #}
        {% set stable_agents = official_agents | filter(attribute="extra.status", value="Stable") %}
        {% set beta_agents = official_agents | filter(attribute="extra.status", value="Beta") %}
        {% set alpha_agents = official_agents | filter(attribute="extra.status", value="Alpha") %}
        {% set planned_agents = official_agents | filter(attribute="extra.status", value="Planned") %}
        {% set deprecated_agents = official_agents | filter(attribute="extra.status", value="Deprecated") %}

        {# Official Agents #}
        {% if official_agents %}
        <details class="agents-category" open>
            <summary class="category-header">
                <div class="category-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/><path d="m9 12 2 2 4-4"/></svg>
                    <h2>Official Agents</h2>
                </div>
                <div class="category-meta">
                    <span class="agent-count">{{ official_agents | length }} agents</span>
                    <svg class="chevron" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
                </div>
            </summary>
            <p class="category-description">Maintained by the Sentinel Core Team</p>
            <div class="agents-grid">
                {# Iterate in order: Stable, Beta, Planned #}
                {% for agent in stable_agents %}
                <article class="agent-card agent-official" data-agent-name="{{ agent.title | lower }}" data-agent-description="{{ agent.description | default(value='') | lower }}" data-agent-tags="{% if agent.taxonomies.tags %}{{ agent.taxonomies.tags | join(sep=' ') | lower }}{% endif %}">
                    <div class="agent-header">
                        <div class="agent-info">
                            <h3 class="agent-name">
                                <a href="{{ agent.permalink | safe }}">{{ agent.title }}</a>
                            </h3>
                            {% if agent.extra.author %}
                            <p class="agent-author">by {{ agent.extra.author }}</p>
                            {% endif %}
                        </div>
                        <div class="agent-header-right">
                            {% if agent.extra.version %}
                            <span class="agent-version">v{{ agent.extra.version }}</span>
                            {% endif %}
                            {% if agent.extra.status %}
                            <span class="agent-status {{ agent.extra.status | lower }}">{{ agent.extra.status }}</span>
                            {% endif %}
                        </div>
                    </div>
                    <p class="agent-description">{{ agent.description | default(value="No description available.") }}</p>

                    {# Install methods badges #}
                    {% if agent.extra.crate_name or agent.extra.docker_image %}
                    <div class="agent-install-badges">
                        {% if agent.extra.crate_name %}
                        <span class="install-badge cargo" title="cargo install {{ agent.extra.crate_name }}">
                            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 16 16"><g fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linejoin="round" stroke-width="1"><path stroke-linecap="round" d="M1.5 7L8 10.5L14.5 7m-10-2.5l3.503 2L14.498 3M4.5 5.5v7m3.5-6V14"/><path stroke-linecap="round" d="M8.003 3L11.5 4.5v8"/><path stroke-linecap="square" d="M1.5 6.984V11l6.503 3.5L14.5 11V3L11 1.5l-6.5 3v1z"/></g></svg>
                            Cargo
                        </span>
                        {% endif %}
                        {% if agent.extra.docker_image %}
                        <span class="install-badge docker" title="docker pull {{ agent.extra.docker_image }}">
                            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path fill="currentColor" d="M13.152.682a2.25 2.25 0 0 1 2.269 0l.007.004l6.957 4.276a2.28 2.28 0 0 1 1.126 1.964v7.516c0 .81-.432 1.56-1.133 1.968l-.002.001l-11.964 7.037l-.004.003c-.706.41-1.578.41-2.284 0l-.026-.015l-6.503-4.502a2.27 2.27 0 0 1-1.096-1.943V9.438c0-.392.1-.77.284-1.1l.003-.006l.014-.026c.197-.342.48-.627.82-.827h.002L13.152.681Zm.757 1.295h-.001L2.648 8.616l6.248 4.247a.78.78 0 0 0 .758-.01h.001l11.633-6.804l-6.629-4.074a.75.75 0 0 0-.75.003ZM8.517 14.33a2.3 2.3 0 0 1-.393-.18l-.023-.014l-6.102-4.147v7.003c0 .275.145.528.379.664l.025.014l6.114 4.232zM18 9.709l-3.25 1.9v7.548L18 17.245Zm-7.59 4.438l-.002.002a2.3 2.3 0 0 1-.391.18v7.612l3.233-1.902v-7.552Zm9.09-5.316v7.532l2.124-1.25a.78.78 0 0 0 .387-.671V7.363Z"/></svg>
                            OCI
                        </span>
                        {% endif %}
                    </div>
                    {% endif %}

                    {% if agent.taxonomies.tags %}
                    <div class="agent-tags">
                        {% for tag in agent.taxonomies.tags %}
                        <span class="agent-tag">{{ tag }}</span>
                        {% endfor %}
                    </div>
                    {% endif %}
                </article>
                {% endfor %}
                {% for agent in beta_agents %}
                <article class="agent-card agent-official" data-agent-name="{{ agent.title | lower }}" data-agent-description="{{ agent.description | default(value='') | lower }}" data-agent-tags="{% if agent.taxonomies.tags %}{{ agent.taxonomies.tags | join(sep=' ') | lower }}{% endif %}">
                    <div class="agent-header">
                        <div class="agent-info">
                            <h3 class="agent-name">
                                <a href="{{ agent.permalink | safe }}">{{ agent.title }}</a>
                            </h3>
                            {% if agent.extra.author %}
                            <p class="agent-author">by {{ agent.extra.author }}</p>
                            {% endif %}
                        </div>
                        <div class="agent-header-right">
                            {% if agent.extra.version %}
                            <span class="agent-version">v{{ agent.extra.version }}</span>
                            {% endif %}
                            {% if agent.extra.status %}
                            <span class="agent-status {{ agent.extra.status | lower }}">{{ agent.extra.status }}</span>
                            {% endif %}
                        </div>
                    </div>
                    <p class="agent-description">{{ agent.description | default(value="No description available.") }}</p>

                    {# Install methods badges #}
                    {% if agent.extra.crate_name or agent.extra.docker_image %}
                    <div class="agent-install-badges">
                        {% if agent.extra.crate_name %}
                        <span class="install-badge cargo" title="cargo install {{ agent.extra.crate_name }}">
                            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 16 16"><g fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linejoin="round" stroke-width="1"><path stroke-linecap="round" d="M1.5 7L8 10.5L14.5 7m-10-2.5l3.503 2L14.498 3M4.5 5.5v7m3.5-6V14"/><path stroke-linecap="round" d="M8.003 3L11.5 4.5v8"/><path stroke-linecap="square" d="M1.5 6.984V11l6.503 3.5L14.5 11V3L11 1.5l-6.5 3v1z"/></g></svg>
                            Cargo
                        </span>
                        {% endif %}
                        {% if agent.extra.docker_image %}
                        <span class="install-badge docker" title="docker pull {{ agent.extra.docker_image }}">
                            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path fill="currentColor" d="M13.152.682a2.25 2.25 0 0 1 2.269 0l.007.004l6.957 4.276a2.28 2.28 0 0 1 1.126 1.964v7.516c0 .81-.432 1.56-1.133 1.968l-.002.001l-11.964 7.037l-.004.003c-.706.41-1.578.41-2.284 0l-.026-.015l-6.503-4.502a2.27 2.27 0 0 1-1.096-1.943V9.438c0-.392.1-.77.284-1.1l.003-.006l.014-.026c.197-.342.48-.627.82-.827h.002L13.152.681Zm.757 1.295h-.001L2.648 8.616l6.248 4.247a.78.78 0 0 0 .758-.01h.001l11.633-6.804l-6.629-4.074a.75.75 0 0 0-.75.003ZM8.517 14.33a2.3 2.3 0 0 1-.393-.18l-.023-.014l-6.102-4.147v7.003c0 .275.145.528.379.664l.025.014l6.114 4.232zM18 9.709l-3.25 1.9v7.548L18 17.245Zm-7.59 4.438l-.002.002a2.3 2.3 0 0 1-.391.18v7.612l3.233-1.902v-7.552Zm9.09-5.316v7.532l2.124-1.25a.78.78 0 0 0 .387-.671V7.363Z"/></svg>
                            OCI
                        </span>
                        {% endif %}
                    </div>
                    {% endif %}

                    {% if agent.taxonomies.tags %}
                    <div class="agent-tags">
                        {% for tag in agent.taxonomies.tags %}
                        <span class="agent-tag">{{ tag }}</span>
                        {% endfor %}
                    </div>
                    {% endif %}
                </article>
                {% endfor %}
                {% for agent in alpha_agents %}
                <article class="agent-card agent-official" data-agent-name="{{ agent.title | lower }}" data-agent-description="{{ agent.description | default(value='') | lower }}" data-agent-tags="{% if agent.taxonomies.tags %}{{ agent.taxonomies.tags | join(sep=' ') | lower }}{% endif %}">
                    <div class="agent-header">
                        <div class="agent-info">
                            <h3 class="agent-name">
                                <a href="{{ agent.permalink | safe }}">{{ agent.title }}</a>
                            </h3>
                            {% if agent.extra.author %}
                            <p class="agent-author">by {{ agent.extra.author }}</p>
                            {% endif %}
                        </div>
                        <div class="agent-header-right">
                            {% if agent.extra.version %}
                            <span class="agent-version">v{{ agent.extra.version }}</span>
                            {% endif %}
                            {% if agent.extra.status %}
                            <span class="agent-status {{ agent.extra.status | lower }}">{{ agent.extra.status }}</span>
                            {% endif %}
                        </div>
                    </div>
                    <p class="agent-description">{{ agent.description | default(value="No description available.") }}</p>

                    {# Install methods badges #}
                    {% if agent.extra.crate_name or agent.extra.docker_image %}
                    <div class="agent-install-badges">
                        {% if agent.extra.crate_name %}
                        <span class="install-badge cargo" title="cargo install {{ agent.extra.crate_name }}">
                            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 16 16"><g fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linejoin="round" stroke-width="1"><path stroke-linecap="round" d="M1.5 7L8 10.5L14.5 7m-10-2.5l3.503 2L14.498 3M4.5 5.5v7m3.5-6V14"/><path stroke-linecap="round" d="M8.003 3L11.5 4.5v8"/><path stroke-linecap="square" d="M1.5 6.984V11l6.503 3.5L14.5 11V3L11 1.5l-6.5 3v1z"/></g></svg>
                            Cargo
                        </span>
                        {% endif %}
                        {% if agent.extra.docker_image %}
                        <span class="install-badge docker" title="docker pull {{ agent.extra.docker_image }}">
                            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path fill="currentColor" d="M13.152.682a2.25 2.25 0 0 1 2.269 0l.007.004l6.957 4.276a2.28 2.28 0 0 1 1.126 1.964v7.516c0 .81-.432 1.56-1.133 1.968l-.002.001l-11.964 7.037l-.004.003c-.706.41-1.578.41-2.284 0l-.026-.015l-6.503-4.502a2.27 2.27 0 0 1-1.096-1.943V9.438c0-.392.1-.77.284-1.1l.003-.006l.014-.026c.197-.342.48-.627.82-.827h.002L13.152.681Zm.757 1.295h-.001L2.648 8.616l6.248 4.247a.78.78 0 0 0 .758-.01h.001l11.633-6.804l-6.629-4.074a.75.75 0 0 0-.75.003ZM8.517 14.33a2.3 2.3 0 0 1-.393-.18l-.023-.014l-6.102-4.147v7.003c0 .275.145.528.379.664l.025.014l6.114 4.232zM18 9.709l-3.25 1.9v7.548L18 17.245Zm-7.59 4.438l-.002.002a2.3 2.3 0 0 1-.391.18v7.612l3.233-1.902v-7.552Zm9.09-5.316v7.532l2.124-1.25a.78.78 0 0 0 .387-.671V7.363Z"/></svg>
                            OCI
                        </span>
                        {% endif %}
                    </div>
                    {% endif %}

                    {% if agent.taxonomies.tags %}
                    <div class="agent-tags">
                        {% for tag in agent.taxonomies.tags %}
                        <span class="agent-tag">{{ tag }}</span>
                        {% endfor %}
                    </div>
                    {% endif %}
                </article>
                {% endfor %}
                {% for agent in planned_agents %}
                <article class="agent-card agent-official" data-agent-name="{{ agent.title | lower }}" data-agent-description="{{ agent.description | default(value='') | lower }}" data-agent-tags="{% if agent.taxonomies.tags %}{{ agent.taxonomies.tags | join(sep=' ') | lower }}{% endif %}">
                    <div class="agent-header">
                        <div class="agent-info">
                            <h3 class="agent-name">
                                <a href="{{ agent.permalink | safe }}">{{ agent.title }}</a>
                            </h3>
                            {% if agent.extra.author %}
                            <p class="agent-author">by {{ agent.extra.author }}</p>
                            {% endif %}
                        </div>
                        <div class="agent-header-right">
                            {% if agent.extra.version %}
                            <span class="agent-version">v{{ agent.extra.version }}</span>
                            {% endif %}
                            {% if agent.extra.status %}
                            <span class="agent-status {{ agent.extra.status | lower }}">{{ agent.extra.status }}</span>
                            {% endif %}
                        </div>
                    </div>
                    <p class="agent-description">{{ agent.description | default(value="No description available.") }}</p>

                    {# Install methods badges #}
                    {% if agent.extra.crate_name or agent.extra.docker_image %}
                    <div class="agent-install-badges">
                        {% if agent.extra.crate_name %}
                        <span class="install-badge cargo" title="cargo install {{ agent.extra.crate_name }}">
                            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 16 16"><g fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linejoin="round" stroke-width="1"><path stroke-linecap="round" d="M1.5 7L8 10.5L14.5 7m-10-2.5l3.503 2L14.498 3M4.5 5.5v7m3.5-6V14"/><path stroke-linecap="round" d="M8.003 3L11.5 4.5v8"/><path stroke-linecap="square" d="M1.5 6.984V11l6.503 3.5L14.5 11V3L11 1.5l-6.5 3v1z"/></g></svg>
                            Cargo
                        </span>
                        {% endif %}
                        {% if agent.extra.docker_image %}
                        <span class="install-badge docker" title="docker pull {{ agent.extra.docker_image }}">
                            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path fill="currentColor" d="M13.152.682a2.25 2.25 0 0 1 2.269 0l.007.004l6.957 4.276a2.28 2.28 0 0 1 1.126 1.964v7.516c0 .81-.432 1.56-1.133 1.968l-.002.001l-11.964 7.037l-.004.003c-.706.41-1.578.41-2.284 0l-.026-.015l-6.503-4.502a2.27 2.27 0 0 1-1.096-1.943V9.438c0-.392.1-.77.284-1.1l.003-.006l.014-.026c.197-.342.48-.627.82-.827h.002L13.152.681Zm.757 1.295h-.001L2.648 8.616l6.248 4.247a.78.78 0 0 0 .758-.01h.001l11.633-6.804l-6.629-4.074a.75.75 0 0 0-.75.003ZM8.517 14.33a2.3 2.3 0 0 1-.393-.18l-.023-.014l-6.102-4.147v7.003c0 .275.145.528.379.664l.025.014l6.114 4.232zM18 9.709l-3.25 1.9v7.548L18 17.245Zm-7.59 4.438l-.002.002a2.3 2.3 0 0 1-.391.18v7.612l3.233-1.902v-7.552Zm9.09-5.316v7.532l2.124-1.25a.78.78 0 0 0 .387-.671V7.363Z"/></svg>
                            OCI
                        </span>
                        {% endif %}
                    </div>
                    {% endif %}

                    {% if agent.taxonomies.tags %}
                    <div class="agent-tags">
                        {% for tag in agent.taxonomies.tags %}
                        <span class="agent-tag">{{ tag }}</span>
                        {% endfor %}
                    </div>
                    {% endif %}
                </article>
                {% endfor %}
            </div>
        </details>
        {% endif %}

        {# Community Agents #}
        <details class="agents-category" open>
            <summary class="category-header">
                <div class="category-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                    <h2>Community Agents</h2>
                </div>
                <div class="category-meta">
                    <span class="agent-count">{{ community_agents | length }} agents</span>
                    <svg class="chevron" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
                </div>
            </summary>
            <p class="category-description">Built and maintained by the community</p>
            <div class="agents-grid">
                {% for agent in community_agents %}
                <article class="agent-card" data-agent-name="{{ agent.title | lower }}" data-agent-description="{{ agent.description | default(value='') | lower }}" data-agent-tags="{% if agent.taxonomies.tags %}{{ agent.taxonomies.tags | join(sep=' ') | lower }}{% endif %}">
                    <div class="agent-header">
                        <div class="agent-info">
                            <h3 class="agent-name">
                                <a href="{{ agent.permalink | safe }}">{{ agent.title }}</a>
                            </h3>
                            {% if agent.extra.author %}
                            <p class="agent-author">by {{ agent.extra.author }}</p>
                            {% endif %}
                        </div>
                        <div class="agent-header-right">
                            {% if agent.extra.version %}
                            <span class="agent-version">v{{ agent.extra.version }}</span>
                            {% endif %}
                            {% if agent.extra.status %}
                            <span class="agent-status {{ agent.extra.status | lower }}">{{ agent.extra.status }}</span>
                            {% endif %}
                        </div>
                    </div>
                    <p class="agent-description">{{ agent.description | default(value="No description available.") }}</p>

                    {# Install methods badges #}
                    {% if agent.extra.crate_name or agent.extra.docker_image %}
                    <div class="agent-install-badges">
                        {% if agent.extra.crate_name %}
                        <span class="install-badge cargo" title="cargo install {{ agent.extra.crate_name }}">
                            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 16 16"><g fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linejoin="round" stroke-width="1"><path stroke-linecap="round" d="M1.5 7L8 10.5L14.5 7m-10-2.5l3.503 2L14.498 3M4.5 5.5v7m3.5-6V14"/><path stroke-linecap="round" d="M8.003 3L11.5 4.5v8"/><path stroke-linecap="square" d="M1.5 6.984V11l6.503 3.5L14.5 11V3L11 1.5l-6.5 3v1z"/></g></svg>
                            Cargo
                        </span>
                        {% endif %}
                        {% if agent.extra.docker_image %}
                        <span class="install-badge docker" title="docker pull {{ agent.extra.docker_image }}">
                            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path fill="currentColor" d="M13.152.682a2.25 2.25 0 0 1 2.269 0l.007.004l6.957 4.276a2.28 2.28 0 0 1 1.126 1.964v7.516c0 .81-.432 1.56-1.133 1.968l-.002.001l-11.964 7.037l-.004.003c-.706.41-1.578.41-2.284 0l-.026-.015l-6.503-4.502a2.27 2.27 0 0 1-1.096-1.943V9.438c0-.392.1-.77.284-1.1l.003-.006l.014-.026c.197-.342.48-.627.82-.827h.002L13.152.681Zm.757 1.295h-.001L2.648 8.616l6.248 4.247a.78.78 0 0 0 .758-.01h.001l11.633-6.804l-6.629-4.074a.75.75 0 0 0-.75.003ZM8.517 14.33a2.3 2.3 0 0 1-.393-.18l-.023-.014l-6.102-4.147v7.003c0 .275.145.528.379.664l.025.014l6.114 4.232zM18 9.709l-3.25 1.9v7.548L18 17.245Zm-7.59 4.438l-.002.002a2.3 2.3 0 0 1-.391.18v7.612l3.233-1.902v-7.552Zm9.09-5.316v7.532l2.124-1.25a.78.78 0 0 0 .387-.671V7.363Z"/></svg>
                            OCI
                        </span>
                        {% endif %}
                    </div>
                    {% endif %}

                    {% if agent.taxonomies.tags %}
                    <div class="agent-tags">
                        {% for tag in agent.taxonomies.tags %}
                        <span class="agent-tag">{{ tag }}</span>
                        {% endfor %}
                    </div>
                    {% endif %}
                </article>
                {% endfor %}

                {# Submit Your Agent placeholder card #}
                <article class="agent-card agent-card-submit">
                    <div class="submit-card-content">
                        <div class="submit-card-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 8v8"/><path d="M8 12h8"/></svg>
                        </div>
                        <h3 class="agent-name">Submit Your Agent</h3>
                        <p class="agent-description">Built something useful? Share it with the community and get it listed here.</p>
                        <a href="https://github.com/raskell-io/sentinel.raskell.io/issues/new?template=new-agent.yml" class="btn btn-secondary btn-sm">
                            Get Listed
                        </a>
                    </div>
                </article>
            </div>
        </details>

        {# Why Agents? - Collapsible #}
        <details class="create-agent-details" open>
            <summary class="create-agent-summary">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/></svg>
                <span>Why Agents?</span>
                <svg class="chevron" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
            </summary>
            <div class="create-agent-content">
                <div class="why-agents">
                    <div class="philosophy-content">
                        <p>
                            Sentinel's core philosophy is simple: <strong>the dataplane should be boring</strong>. Stable, bounded, predictable.
                            No 3 AM wake-ups. No memory explosions. No cascading failures from a misbehaving script.
                        </p>
                        <p>
                            But the real world demands more than routing packets. You need WAF rules, authentication flows,
                            rate limiting, bot detection, content filtering, ML-based threat scoring, custom business logic—the
                            list grows with every new attack vector and compliance requirement.
                        </p>
                        <p>
                            <strong>Agents are where innovation lives.</strong> By moving complex logic to external processes behind a
                            stable contract, we get the best of both worlds: a rock-solid dataplane that never crashes, and unlimited
                            extensibility for security policies. A broken agent cannot crash Sentinel. It gets circuit-broken,
                            falls back to a safe default, and life goes on.
                        </p>
                        <p>
                            We believe the future of reverse proxies lies in <strong>custom policy enforcement through external processing</strong>.
                            Not embedded scripting runtimes. Not monolithic rule engines. But modular, isolated, language-agnostic
                            agents that anyone can build, deploy, and evolve independently.
                        </p>
                        <p>
                            This is how we keep the internet safe: by enabling <em>everyone</em>—from solo developers to enterprise
                            security teams—to implement their own policies without compromising the stability of the underlying
                            infrastructure. Your WAF rules, your auth logic, your rate limits, your threat models. Sentinel just
                            makes sure the traffic flows reliably while your agents make the decisions.
                        </p>
                    </div>
                    <div class="philosophy-principles">
                        <div class="principle">
                            <div class="principle-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/><path d="m9 12 2 2 4-4"/></svg>
                            </div>
                            <div class="principle-text">
                                <strong>Isolation</strong>
                                <span>Agent crashes don't crash Sentinel</span>
                            </div>
                        </div>
                        <div class="principle">
                            <div class="principle-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                            </div>
                            <div class="principle-text">
                                <strong>Bounded</strong>
                                <span>Hard timeouts and circuit breakers everywhere</span>
                            </div>
                        </div>
                        <div class="principle">
                            <div class="principle-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3v18"/><path d="M3 12h18"/></svg>
                            </div>
                            <div class="principle-text">
                                <strong>Extensible</strong>
                                <span>Build agents in any language you want</span>
                            </div>
                        </div>
                        <div class="principle">
                            <div class="principle-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/></svg>
                            </div>
                            <div class="principle-text">
                                <strong>Modular</strong>
                                <span>Deploy and upgrade agents independently</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </details>

        {# How Agents Work - Collapsible #}
        <details class="create-agent-details" open>
            <summary class="create-agent-summary">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><path d="M12 17h.01"/></svg>
                <span>How Agents Work</span>
                <svg class="chevron" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
            </summary>
            <div class="create-agent-content">
                <p>
                    Agents are external processes that extend Sentinel's capabilities. They communicate via
                    <strong>Unix domain sockets</strong> (for local agents) or <strong>gRPC</strong> (for remote/distributed agents),
                    using the protocol defined in the <a href="https://github.com/raskell-io/sentinel/tree/main/crates/agent-protocol" target="_blank" rel="noopener"><code>agent-protocol</code></a> crate.
                    This allows you to implement custom security logic in any language.
                </p>

                <div class="agent-explainer">
                    <h3>Architecture</h3>
                    <div class="explainer-grid">
                        <div class="explainer-item">
                            <div class="explainer-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/></svg>
                            </div>
                            <div class="explainer-content">
                                <strong>Process Isolation</strong>
                                <span>Each agent runs as a separate OS process with its own memory space, providing security boundaries and crash isolation</span>
                            </div>
                        </div>
                        <div class="explainer-item">
                            <div class="explainer-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 6.1H3"/><path d="M21 12.1H3"/><path d="M15.1 18H3"/></svg>
                            </div>
                            <div class="explainer-content">
                                <strong>Unix Socket &amp; gRPC</strong>
                                <span>Two transport options: <a href="https://github.com/raskell-io/sentinel/blob/main/crates/agent-protocol/docs/protocol.md" target="_blank" rel="noopener">Unix domain sockets</a> for local agents (4-byte length prefix + JSON), or <a href="https://github.com/raskell-io/sentinel/blob/main/crates/agent-protocol/docs/protocol.md" target="_blank" rel="noopener">gRPC</a> for remote/distributed agents</span>
                            </div>
                        </div>
                        <div class="explainer-item">
                            <div class="explainer-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3v18"/><path d="M3 12h18"/></svg>
                            </div>
                            <div class="explainer-content">
                                <strong>Connection Pooling</strong>
                                <span>Sentinel maintains persistent connections to agents, eliminating connection overhead per request</span>
                            </div>
                        </div>
                        <div class="explainer-item">
                            <div class="explainer-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="m10 13-2 2 2 2"/><path d="m14 17 2-2-2-2"/></svg>
                            </div>
                            <div class="explainer-content">
                                <strong>Language Agnostic</strong>
                                <span>Write agents in Rust, Go, Python, TypeScript, or any language that can read/write Unix sockets</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="agent-explainer">
                    <h3>Request Lifecycle</h3>
                    <div class="explainer-grid">
                        <div class="explainer-item">
                            <div class="explainer-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2"/><path d="M18 14h-8"/><path d="M15 18h-5"/><path d="M10 6h8v4h-8V6Z"/></svg>
                            </div>
                            <div class="explainer-content">
                                <strong>Event Hooks</strong>
                                <span>Subscribe to <code>request_headers</code>, <code>request_body</code>, <code>response_headers</code>, and <code>response_body</code> events</span>
                            </div>
                        </div>
                        <div class="explainer-item">
                            <div class="explainer-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="m4.9 4.9 14.2 14.2"/></svg>
                            </div>
                            <div class="explainer-content">
                                <strong>Decision Types</strong>
                                <span>Return <code>Allow</code>, <code>Deny</code>, <code>Redirect</code>, or <code>Challenge</code> decisions with optional modifications</span>
                            </div>
                        </div>
                        <div class="explainer-item">
                            <div class="explainer-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20h9"/><path d="M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z"/></svg>
                            </div>
                            <div class="explainer-content">
                                <strong>Header Manipulation</strong>
                                <span>Add, modify, or remove request/response headers. Inject correlation IDs, auth tokens, or security headers</span>
                            </div>
                        </div>
                        <div class="explainer-item">
                            <div class="explainer-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/><path d="M16 13H8"/><path d="M16 17H8"/><path d="M10 9H8"/></svg>
                            </div>
                            <div class="explainer-content">
                                <strong>Audit Metadata</strong>
                                <span>Attach structured tags and metadata to requests for logging, metrics, and downstream processing</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="agent-explainer">
                    <h3>Failure Handling</h3>
                    <div class="explainer-grid">
                        <div class="explainer-item">
                            <div class="explainer-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                            </div>
                            <div class="explainer-content">
                                <strong>Fail-Open Mode</strong>
                                <span>Configure agents to allow traffic when unavailable, ensuring availability over strict enforcement</span>
                            </div>
                        </div>
                        <div class="explainer-item">
                            <div class="explainer-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                            </div>
                            <div class="explainer-content">
                                <strong>Timeout Control</strong>
                                <span>Per-agent timeout configuration (default 100ms) prevents slow agents from blocking the request path</span>
                            </div>
                        </div>
                        <div class="explainer-item">
                            <div class="explainer-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/></svg>
                            </div>
                            <div class="explainer-content">
                                <strong>Auto-Reconnect</strong>
                                <span>Sentinel automatically reconnects to agents after crashes with exponential backoff</span>
                            </div>
                        </div>
                        <div class="explainer-item">
                            <div class="explainer-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
                            </div>
                            <div class="explainer-content">
                                <strong>Health Metrics</strong>
                                <span>Prometheus metrics for agent latency, error rates, and connection status via <code>/metrics</code> endpoint</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="protocol-docs-links">
                    <h4>Protocol Documentation</h4>
                    <div class="docs-grid">
                        <a href="https://github.com/raskell-io/sentinel/blob/main/crates/agent-protocol/docs/architecture.md" target="_blank" rel="noopener" class="doc-link">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M3 9h18"/><path d="M9 21V9"/></svg>
                            Architecture
                        </a>
                        <a href="https://github.com/raskell-io/sentinel/blob/main/crates/agent-protocol/docs/protocol.md" target="_blank" rel="noopener" class="doc-link">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3v18"/><path d="M3 12h18"/></svg>
                            Wire Protocol
                        </a>
                        <a href="https://github.com/raskell-io/sentinel/blob/main/crates/agent-protocol/docs/handler.md" target="_blank" rel="noopener" class="doc-link">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/></svg>
                            Handler Interface
                        </a>
                        <a href="https://github.com/raskell-io/sentinel/blob/main/crates/agent-protocol/docs/api.md" target="_blank" rel="noopener" class="doc-link">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m10 13-2 2 2 2"/><path d="m14 17 2-2-2-2"/><rect width="18" height="14" x="3" y="5" rx="2"/></svg>
                            Client/Server API
                        </a>
                        <a href="https://github.com/raskell-io/sentinel/blob/main/crates/agent-protocol/docs/errors.md" target="_blank" rel="noopener" class="doc-link">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="m15 9-6 6"/><path d="m9 9 6 6"/></svg>
                            Error Handling
                        </a>
                        <a href="https://github.com/raskell-io/sentinel/blob/main/crates/agent-protocol/docs/examples.md" target="_blank" rel="noopener" class="doc-link">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m18 16 4-4-4-4"/><path d="m6 8-4 4 4 4"/><path d="m14.5 4-5 16"/></svg>
                            Examples
                        </a>
                    </div>
                </div>
            </div>
        </details>

        {# Create Your Own Agent - Collapsible #}
        <details class="create-agent-details" open>
            <summary class="create-agent-summary">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z"/></svg>
                <span>Create Your Own Agent</span>
                <svg class="chevron" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
            </summary>
            <div class="create-agent-content">
                <p>
                    Extend Sentinel with custom security logic, authentication, rate limiting, or any HTTP processing you need.
                    Use one of our official SDKs or implement the protocol directly.
                </p>

                {# SDK Cards #}
                <h3>Official SDKs</h3>
                <p class="sdk-intro">Choose the SDK for your preferred language. Each provides a simple, idiomatic API for building agents.</p>
                <div class="sdk-grid">
                    <a href="https://github.com/raskell-io/sentinel-agent-rust-sdk" class="sdk-card" target="_blank" rel="noopener">
                        <div class="sdk-header">
                            <div class="sdk-logo rust">
                                <img src="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/rust/rust-original.svg" alt="Rust" width="28" height="28">
                            </div>
                            <div class="sdk-info">
                                <span class="sdk-name">Rust SDK</span>
                                <span class="sdk-package">sentinel-agent-sdk</span>
                            </div>
                        </div>
                        <p class="sdk-description">Native performance with zero-cost abstractions. Uses the same protocol crate as Sentinel itself.</p>
                        <div class="sdk-footer">
                            <span class="sdk-install">cargo add sentinel-agent-sdk</span>
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" x2="21" y1="14" y2="3"/></svg>
                        </div>
                    </a>

                    <a href="https://github.com/raskell-io/sentinel-agent-go-sdk" class="sdk-card" target="_blank" rel="noopener">
                        <div class="sdk-header">
                            <div class="sdk-logo go">
                                <img src="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/go/go-original-wordmark.svg" alt="Go" width="28" height="28">
                            </div>
                            <div class="sdk-info">
                                <span class="sdk-name">Go SDK</span>
                                <span class="sdk-package">sentinel-agent-sdk</span>
                            </div>
                        </div>
                        <p class="sdk-description">Idiomatic Go with goroutine-per-connection model. Simple, fast, and production-ready.</p>
                        <div class="sdk-footer">
                            <span class="sdk-install">go get github.com/raskell-io/sentinel-agent-go-sdk</span>
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" x2="21" y1="14" y2="3"/></svg>
                        </div>
                    </a>

                    <a href="https://github.com/raskell-io/sentinel-agent-kotlin-sdk" class="sdk-card" target="_blank" rel="noopener">
                        <div class="sdk-header">
                            <div class="sdk-logo kotlin">
                                <img src="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/kotlin/kotlin-original.svg" alt="Kotlin" width="28" height="28">
                            </div>
                            <div class="sdk-info">
                                <span class="sdk-name">Kotlin SDK</span>
                                <span class="sdk-package">sentinel-agent-sdk</span>
                            </div>
                        </div>
                        <p class="sdk-description">Coroutine-based async agents with excellent Java interop. Ideal for JVM environments.</p>
                        <div class="sdk-footer">
                            <span class="sdk-install">implementation("io.raskell:sentinel-agent-sdk:0.2.0")</span>
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" x2="21" y1="14" y2="3"/></svg>
                        </div>
                    </a>

                    <a href="https://github.com/raskell-io/sentinel-agent-python-sdk" class="sdk-card" target="_blank" rel="noopener">
                        <div class="sdk-header">
                            <div class="sdk-logo python">
                                <img src="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/python/python-original.svg" alt="Python" width="28" height="28">
                            </div>
                            <div class="sdk-info">
                                <span class="sdk-name">Python SDK</span>
                                <span class="sdk-package">sentinel-agent-sdk</span>
                            </div>
                        </div>
                        <p class="sdk-description">Async-first design with asyncio. Fluent Decision builder and typed configuration support.</p>
                        <div class="sdk-footer">
                            <span class="sdk-install">pip install sentinel-agent-sdk</span>
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" x2="21" y1="14" y2="3"/></svg>
                        </div>
                    </a>

                    <a href="https://github.com/raskell-io/sentinel-agent-typescript-sdk" class="sdk-card" target="_blank" rel="noopener">
                        <div class="sdk-header">
                            <div class="sdk-logo typescript">
                                <img src="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/typescript/typescript-original.svg" alt="TypeScript" width="28" height="28">
                            </div>
                            <div class="sdk-info">
                                <span class="sdk-name">TypeScript SDK</span>
                                <span class="sdk-package">@sentinel-proxy/agent-sdk</span>
                            </div>
                        </div>
                        <p class="sdk-description">Full type safety with TypeScript. Works with Node.js, Deno, and Bun runtimes.</p>
                        <div class="sdk-footer">
                            <span class="sdk-install">npm install @sentinel-proxy/agent-sdk</span>
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" x2="21" y1="14" y2="3"/></svg>
                        </div>
                    </a>

                    <a href="https://github.com/raskell-io/sentinel-agent-elixir-sdk" class="sdk-card" target="_blank" rel="noopener">
                        <div class="sdk-header">
                            <div class="sdk-logo elixir">
                                <img src="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/elixir/elixir-original.svg" alt="Elixir" width="28" height="28">
                            </div>
                            <div class="sdk-info">
                                <span class="sdk-name">Elixir SDK</span>
                                <span class="sdk-package">sentinel_agent_sdk</span>
                            </div>
                        </div>
                        <p class="sdk-description">Fault-tolerant agents with OTP supervision. Perfect for distributed, resilient systems.</p>
                        <div class="sdk-footer">
                            <span class="sdk-install">mix deps.get sentinel_agent_sdk</span>
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" x2="21" y1="14" y2="3"/></svg>
                        </div>
                    </a>
                </div>

                {# Getting Started Steps #}
                <h3>Quick Start</h3>
                <div class="cta-steps">
                    <div class="cta-step">
                        <span class="step-number">1</span>
                        <div class="step-content">
                            <strong>Install an SDK</strong>
                            <span>Choose your preferred language and install the SDK using your package manager</span>
                        </div>
                    </div>
                    <div class="cta-step">
                        <span class="step-number">2</span>
                        <div class="step-content">
                            <strong>Implement your agent</strong>
                            <span>Create an agent class that handles <code>on_request</code> and returns a decision (allow, block, redirect)</span>
                        </div>
                    </div>
                    <div class="cta-step">
                        <span class="step-number">3</span>
                        <div class="step-content">
                            <strong>Configure Sentinel</strong>
                            <span>Add your agent to the Sentinel config with a Unix socket path and attach it to routes via filters</span>
                        </div>
                    </div>
                    <div class="cta-step">
                        <span class="step-number">4</span>
                        <div class="step-content">
                            <strong>Run and test</strong>
                            <span>Start your agent, reload Sentinel, and verify your logic with test requests</span>
                        </div>
                    </div>
                </div>

                {# Code Example #}
                <h3>Example: Block Admin Paths</h3>
                <div class="code-example">
                    <div class="code-tabs">
                        <button class="code-tab active" data-lang="rust">Rust</button>
                        <button class="code-tab" data-lang="go">Go</button>
                        <button class="code-tab" data-lang="kotlin">Kotlin</button>
                        <button class="code-tab" data-lang="python">Python</button>
                        <button class="code-tab" data-lang="typescript">TypeScript</button>
                        <button class="code-tab" data-lang="elixir">Elixir</button>
                    </div>
                    <div class="code-panels">
                        <pre class="code-panel active language-rust" data-lang="rust"><code class="language-rust">use sentinel_agent_sdk::{Agent, Decision, Request};

struct MyAgent;

impl Agent for MyAgent {
    async fn on_request(&amp;self, req: &amp;Request) -&gt; Decision {
        if req.path().starts_with("/admin") {
            Decision::deny()
                .with_body("Access denied")
                .with_tag("blocked")
        } else {
            Decision::allow()
        }
    }
}</code></pre>
                        <pre class="code-panel language-go" data-lang="go"><code class="language-go">package main

import "github.com/raskell-io/sentinel-agent-go-sdk/agent"

type MyAgent struct{}

func (a *MyAgent) OnRequest(req *agent.Request) *agent.Decision {
    if strings.HasPrefix(req.Path(), "/admin") {
        return agent.Deny().
            WithBody("Access denied").
            WithTag("blocked")
    }
    return agent.Allow()
}</code></pre>
                        <pre class="code-panel language-kotlin" data-lang="kotlin"><code class="language-kotlin">import io.raskell.sentinel.agent.*

class MyAgent : Agent {
    override val name = "my-agent"

    override suspend fun onRequest(request: Request): Decision {
        return if (request.path.startsWith("/admin")) {
            Decision.deny()
                .withBody("Access denied")
                .withTag("blocked")
        } else {
            Decision.allow()
        }
    }
}</code></pre>
                        <pre class="code-panel language-python" data-lang="python"><code class="language-python">from sentinel_agent_sdk import Agent, Decision, Request

class MyAgent(Agent):
    @property
    def name(self) -> str:
        return "my-agent"

    async def on_request(self, request: Request) -> Decision:
        if request.path_starts_with("/admin"):
            return Decision.deny().with_body("Access denied").with_tag("blocked")
        return Decision.allow()</code></pre>
                        <pre class="code-panel language-typescript" data-lang="typescript"><code class="language-typescript">import { Agent, Decision, Request } from '@sentinel-proxy/agent-sdk';

class MyAgent extends Agent {
    name = 'my-agent';

    async onRequest(request: Request): Promise&lt;Decision&gt; {
        if (request.path.startsWith('/admin')) {
            return Decision.deny()
                .withBody('Access denied')
                .withTag('blocked');
        }
        return Decision.allow();
    }
}</code></pre>
                        <pre class="code-panel language-elixir" data-lang="elixir"><code class="language-elixir">defmodule MyAgent do
  use SentinelAgentSdk.Agent

  @impl true
  def name, do: "my-agent"

  @impl true
  def on_request(request) do
    if String.starts_with?(request.path, "/admin") do
      Decision.deny()
      |> Decision.with_body("Access denied")
      |> Decision.with_tag("blocked")
    else
      Decision.allow()
    end
  end
end</code></pre>
                    </div>
                </div>

                {# Sentinel Configuration #}
                <h3>Sentinel Configuration</h3>
                <p>Configure Sentinel to connect to your agent:</p>
                <pre class="config-example language-kdl"><code class="language-kdl">agents {
    agent "my-agent" type="custom" {
        unix-socket path="/tmp/my-agent.sock"
        events "request_headers"
        timeout-ms 100
        failure-mode "open"
    }
}

filters {
    filter "my-filter" {
        type "agent"
        agent "my-agent"
    }
}

routes {
    route "api" {
        matches { path-prefix "/api/" }
        upstream "backend"
        filters "my-filter"
    }
}</code></pre>
            </div>
        </details>
    </div>
</section>

<script>
(function() {
    // Agent search functionality
    const searchInput = document.getElementById('agent-search');
    const agentCards = document.querySelectorAll('.agent-card[data-agent-name]');
    const categories = document.querySelectorAll('.agents-category');

    searchInput.addEventListener('input', function() {
        const query = this.value.toLowerCase().trim();

        agentCards.forEach(card => {
            const name = card.dataset.agentName || '';
            const description = card.dataset.agentDescription || '';
            const tags = card.dataset.agentTags || '';

            const matches = query === '' ||
                name.includes(query) ||
                description.includes(query) ||
                tags.includes(query);

            card.style.display = matches ? '' : 'none';
        });

        // Update category counts and visibility
        categories.forEach(category => {
            const grid = category.querySelector('.agents-grid');
            if (!grid) return;

            const visibleCards = grid.querySelectorAll('.agent-card[data-agent-name]:not([style*="display: none"])');
            const countEl = category.querySelector('.agent-count');

            if (countEl) {
                const count = visibleCards.length;
                countEl.textContent = count + (count === 1 ? ' agent' : ' agents');
            }

            // Keep categories expanded when searching
            if (query !== '' && visibleCards.length > 0) {
                category.open = true;
            }
        });
    });

    // Code example tabs
    const codeTabs = document.querySelectorAll('.code-tab');
    const codePanels = document.querySelectorAll('.code-panel');

    codeTabs.forEach(tab => {
        tab.addEventListener('click', function() {
            const lang = this.dataset.lang;

            // Update active tab
            codeTabs.forEach(t => t.classList.remove('active'));
            this.classList.add('active');

            // Update active panel
            codePanels.forEach(panel => {
                panel.classList.toggle('active', panel.dataset.lang === lang);
            });
        });
    });

})();
</script>

<!-- Prism.js for syntax highlighting -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-rust.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-go.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-typescript.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-kotlin.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-elixir.min.js"></script>
<script>
(function() {
    // Define KDL language for Prism (Sentinel config format)
    Prism.languages.kdl = {
        'comment': {
            pattern: /\/\/.*|\/\*[\s\S]*?\*\/|#.*/,
            greedy: true
        },
        'string': {
            pattern: /"(?:[^"\\]|\\.)*"/,
            greedy: true
        },
        'keyword': /\b(?:true|false|null)\b/,
        'number': /\b-?(?:0x[\da-fA-F]+|\d+(?:\.\d+)?(?:[eE][+-]?\d+)?)\b/,
        'attr-name': /[a-zA-Z_][\w-]*(?=\s*=)/,
        'property': /\b(?:type|path|events|timeout-ms|failure-mode|agent|matches|upstream|filters|unix-socket)\b/,
        'node': {
            pattern: /\b(?:agents|agent|filters|filter|routes|route|upstreams|upstream|listeners|listener)\b/,
            alias: 'class-name'
        },
        'function': /[a-zA-Z_][\w-]*(?=\s*\{)/,
        'operator': /[=]/,
        'punctuation': /[{}]/
    };

    // Highlight all code blocks
    Prism.highlightAll();

    // Also re-highlight when tabs are switched
    document.querySelectorAll('.code-tab').forEach(function(tab) {
        tab.addEventListener('click', function() {
            setTimeout(function() {
                Prism.highlightAll();
            }, 10);
        });
    });
})();
</script>
{% endblock %}
