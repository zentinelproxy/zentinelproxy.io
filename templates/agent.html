{% extends "base.html" %}

{% block title %}{{ page.title }} | Agents | {{ config.title }}{% endblock %}
{% block description %}{{ page.description | default(value=config.description) }}{% endblock %}
{% block og_title %}{{ page.title }} | Agents | {{ config.title }}{% endblock %}
{% block og_description %}{{ page.description | default(value=config.description) }}{% endblock %}
{% block twitter_title %}{{ page.title }} | Agents | {{ config.title }}{% endblock %}
{% block twitter_description %}{{ page.description | default(value=config.description) }}{% endblock %}
{% block jsonld_title %}{{ page.title }} | Agents | {{ config.title }}{% endblock %}
{% block jsonld_description %}{{ page.description | default(value=config.description) }}{% endblock %}

{% block jsonld_breadcrumb %}
,{
    "@type": "BreadcrumbList",
    "@id": "{{ current_url | safe }}/#breadcrumb",
    "itemListElement": [
        {
            "@type": "ListItem",
            "position": 1,
            "name": "Home",
            "item": "{{ config.base_url | safe }}"
        },
        {
            "@type": "ListItem",
            "position": 2,
            "name": "Agents",
            "item": "{{ get_url(path='/agents/') | safe }}"
        },
        {
            "@type": "ListItem",
            "position": 3,
            "name": "{{ page.title }}",
            "item": "{{ current_url | safe }}"
        }
    ]
}
{% if page.extra.crate_name or page.extra.official %}
,{
    "@type": "SoftwareApplication",
    "@id": "{{ current_url | safe }}/#software",
    "name": "{{ page.title }}",
    "description": "{{ page.description | default(value='Sentinel agent') }}",
    "applicationCategory": "SecurityApplication",
    "operatingSystem": "Cross-platform",
    {% if page.extra.version %}"softwareVersion": "{{ page.extra.version }}",{% endif %}
    {% if page.extra.license %}"license": "{{ page.extra.license }}",{% endif %}
    {% if page.extra.author %}"author": {
        "@type": "{% if page.extra.official %}Organization{% else %}Person{% endif %}",
        "name": "{{ page.extra.author }}"
        {% if page.extra.author_url %},"url": "{{ page.extra.author_url }}"{% endif %}
    },{% endif %}
    {% if page.extra.repo %}"codeRepository": "{{ page.extra.repo }}",{% endif %}
    "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
    }
}
{% endif %}
{% endblock %}

{% block content %}
<article class="article" itemscope itemtype="https://schema.org/TechArticle" aria-labelledby="article-title">
    <div class="container container-narrow">
        <header class="article-header">
            <nav class="breadcrumb" role="navigation" aria-label="Breadcrumb">
                <a href="/agents/">Agents</a>
                <span aria-hidden="true">/</span>
                <span aria-current="page">{{ page.title }}</span>
            </nav>
            <div class="agent-header-detail">
                <h1 id="article-title" itemprop="headline">{{ page.title }}</h1>
                <div class="agent-badges">
                    {% if page.extra.official %}
                    <span class="agent-badge-official">
                        <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/><path d="m9 12 2 2 4-4"/></svg>
                        Official
                    </span>
                    {% endif %}
                    {% if page.extra.status %}
                    <span class="agent-status {{ page.extra.status | lower }}">{{ page.extra.status }}</span>
                    {% endif %}
                </div>
            </div>
            {% if page.description %}
            <p class="article-description" itemprop="description">{{ page.description }}</p>
            {% endif %}

            {# Agent Meta Information #}
            <div class="agent-meta">
                {% if page.extra.version %}
                <span class="meta-item">
                    <strong>Version:</strong> {{ page.extra.version }}
                </span>
                {% endif %}
                {% if page.extra.author %}
                <span class="meta-item">
                    <strong>Author:</strong>
                    {% if page.extra.author_url %}
                    <a href="{{ page.extra.author_url }}" target="_blank" rel="noopener">{{ page.extra.author }}</a>
                    {% else %}
                    {{ page.extra.author }}
                    {% endif %}
                </span>
                {% endif %}
                {% if page.extra.license %}
                <span class="meta-item">
                    <strong>License:</strong> {{ page.extra.license }}
                </span>
                {% endif %}
                {% if page.extra.protocol_version %}
                <span class="meta-item">
                    <strong>Protocol:</strong> v{{ page.extra.protocol_version }}
                </span>
                {% endif %}
                {% if page.extra.repo %}
                <span class="meta-item">
                    <a href="{{ page.extra.repo }}" target="_blank" rel="noopener">
                        <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"/><path d="M9 18c-4.51 2-5-2-7-2"/></svg>
                        View Source
                    </a>
                </span>
                {% endif %}
            </div>

            {# Quick Install Section #}
            {% if page.extra.crate_name or page.extra.docker_image %}
            <div class="agent-install-quick">
                <h3>Quick Install</h3>
                <div class="install-methods">
                    {% if page.extra.crate_name %}
                    <div class="install-method">
                        <span class="install-label">
                            <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><g fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linejoin="round" stroke-width="1"><path stroke-linecap="round" d="M1.5 7L8 10.5L14.5 7m-10-2.5l3.503 2L14.498 3M4.5 5.5v7m3.5-6V14"/><path stroke-linecap="round" d="M8.003 3L11.5 4.5v8"/><path stroke-linecap="square" d="M1.5 6.984V11l6.503 3.5L14.5 11V3L11 1.5l-6.5 3v1z"/></g></svg>
                            Cargo
                        </span>
                        <div class="install-cmd-wrapper">
                            <code class="install-cmd">cargo install {{ page.extra.crate_name }}</code>
                            <button class="copy-btn" onclick="copyCommand(this, 'cargo install {{ page.extra.crate_name }}')" title="Copy to clipboard" aria-label="Copy cargo install command">
                                <svg class="icon-copy" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>
                                <svg class="icon-check" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display:none;"><path d="M20 6 9 17l-5-5"/></svg>
                            </button>
                        </div>
                    </div>
                    {% endif %}
                    {% if page.extra.docker_image %}
                    <div class="install-method">
                        <span class="install-label">
                            <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path fill="currentColor" d="M13.152.682a2.25 2.25 0 0 1 2.269 0l.007.004l6.957 4.276a2.28 2.28 0 0 1 1.126 1.964v7.516c0 .81-.432 1.56-1.133 1.968l-.002.001l-11.964 7.037l-.004.003c-.706.41-1.578.41-2.284 0l-.026-.015l-6.503-4.502a2.27 2.27 0 0 1-1.096-1.943V9.438c0-.392.1-.77.284-1.1l.003-.006l.014-.026c.197-.342.48-.627.82-.827h.002L13.152.681Zm.757 1.295h-.001L2.648 8.616l6.248 4.247a.78.78 0 0 0 .758-.01h.001l11.633-6.804l-6.629-4.074a.75.75 0 0 0-.75.003ZM8.517 14.33a2.3 2.3 0 0 1-.393-.18l-.023-.014l-6.102-4.147v7.003c0 .275.145.528.379.664l.025.014l6.114 4.232zM18 9.709l-3.25 1.9v7.548L18 17.245Zm-7.59 4.438l-.002.002a2.3 2.3 0 0 1-.391.18v7.612l3.233-1.902v-7.552Zm9.09-5.316v7.532l2.124-1.25a.78.78 0 0 0 .387-.671V7.363Z"/></svg>
                            OCI Container
                        </span>
                        <div class="install-cmd-wrapper">
                            <code class="install-cmd">docker pull {{ page.extra.docker_image }}</code>
                            <button class="copy-btn" onclick="copyCommand(this, 'docker pull {{ page.extra.docker_image }}')" title="Copy to clipboard" aria-label="Copy docker pull command">
                                <svg class="icon-copy" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>
                                <svg class="icon-check" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display:none;"><path d="M20 6 9 17l-5-5"/></svg>
                            </button>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
            {% endif %}
        </header>

        <div class="article-content prose" itemprop="articleBody">
            {{ page.content | safe }}
        </div>

        {% if page.taxonomies.tags %}
        <footer class="article-footer">
            <nav class="agent-tags" role="navigation" aria-label="Article tags" itemprop="keywords">
                {% for tag in page.taxonomies.tags %}
                <a href="/tags/{{ tag | slugify }}/" class="agent-tag">{{ tag }}</a>
                {% endfor %}
            </nav>

            {# Contribution CTA #}
            <div class="agent-contribute">
                <p>
                    Found an issue or want to improve this agent?
                    {% if page.extra.repo %}
                    <a href="{{ page.extra.repo }}/issues" target="_blank" rel="noopener">Open an issue</a> or
                    <a href="{{ page.extra.repo }}/pulls" target="_blank" rel="noopener">submit a PR</a>.
                    {% else %}
                    <a href="https://github.com/raskell-io/sentinel.raskell.io/issues" target="_blank" rel="noopener">Let us know</a>.
                    {% endif %}
                </p>
            </div>
        </footer>
        {% endif %}
    </div>
</article>

<script>
function copyCommand(btn, command) {
    navigator.clipboard.writeText(command);
    const iconCopy = btn.querySelector('.icon-copy');
    const iconCheck = btn.querySelector('.icon-check');
    iconCopy.style.display = 'none';
    iconCheck.style.display = 'block';
    setTimeout(() => {
        iconCopy.style.display = 'block';
        iconCheck.style.display = 'none';
    }, 2000);
}
</script>
{% endblock %}
